{"version":3,"file":"multer.js","names":["accessClient","region","process","env","AWS_REGION","accessKeyId","AWS_ACCESS_KEY2","secretAccessKey","AWS_SECRET_KEY2","s3","S3","storage","multerS3","bucket","AWS_BUCKET","metadata","req","file","cb","fieldName","fieldname","key","name","originalname","split","campo","path","extname","upload","multer"],"sources":["../../src/middlewares/multer.js"],"sourcesContent":["import multer from 'multer'\r\nimport S3 from 'aws-sdk/clients/s3'\r\nimport path from 'path'\r\nimport multerS3 from 'multer-s3'\r\nimport 'dotenv/config'\r\n\r\nconst accessClient = {\r\n    region: process.env.AWS_REGION,\r\n    accessKeyId: process.env.AWS_ACCESS_KEY2,\r\n    secretAccessKey: process.env.AWS_SECRET_KEY2\r\n}\r\n\r\nconst s3 = new S3(accessClient);\r\n\r\nconst storage = multerS3({\r\n    s3: s3,\r\n    bucket: process.env.AWS_BUCKET,\r\n    metadata: (req, file, cb) => {\r\n        cb(null, { fieldName: file.fieldname });\r\n    },\r\n    key: (req, file, cb) => {\r\n        let name = file.originalname.split('.')[0];\r\n        let campo = name + path.extname(file.originalname);\r\n        // let alternativo = new Date().getTime() + path.extname(file.originalname);\r\n        // let campo = nanoid() + path.extname(file.originalname);\r\n        cb(null, campo);\r\n        // cb(null, alternativo);\r\n    }\r\n});\r\n\r\nconst upload = multer({ storage });\r\n\r\nexport default upload;"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,YAAY,GAAG;EACjBC,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADH;EAEjBC,WAAW,EAAEH,OAAO,CAACC,GAAR,CAAYG,eAFR;EAGjBC,eAAe,EAAEL,OAAO,CAACC,GAAR,CAAYK;AAHZ,CAArB;AAMA,IAAMC,EAAE,GAAG,IAAIC,UAAJ,CAAOV,YAAP,CAAX;AAEA,IAAMW,OAAO,GAAG,IAAAC,gBAAA,EAAS;EACrBH,EAAE,EAAEA,EADiB;EAErBI,MAAM,EAAEX,OAAO,CAACC,GAAR,CAAYW,UAFC;EAGrBC,QAAQ,EAAE,kBAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;IACzBA,EAAE,CAAC,IAAD,EAAO;MAAEC,SAAS,EAAEF,IAAI,CAACG;IAAlB,CAAP,CAAF;EACH,CALoB;EAMrBC,GAAG,EAAE,aAACL,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;IACpB,IAAII,IAAI,GAAGL,IAAI,CAACM,YAAL,CAAkBC,KAAlB,CAAwB,GAAxB,EAA6B,CAA7B,CAAX;;IACA,IAAIC,KAAK,GAAGH,IAAI,GAAGI,aAAA,CAAKC,OAAL,CAAaV,IAAI,CAACM,YAAlB,CAAnB,CAFoB,CAGpB;IACA;;;IACAL,EAAE,CAAC,IAAD,EAAOO,KAAP,CAAF,CALoB,CAMpB;EACH;AAboB,CAAT,CAAhB;AAgBA,IAAMG,MAAM,GAAG,IAAAC,eAAA,EAAO;EAAElB,OAAO,EAAPA;AAAF,CAAP,CAAf;eAEeiB,M"}