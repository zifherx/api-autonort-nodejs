{"version":3,"file":"verifySignup.js","names":["checkDuplicateUsernameOrEmail","req","res","next","User","findOne","username","body","user","status","json","message","email","checkRolesExist","roles","h","size","ROLES","includes"],"sources":["../../src/middlewares/verifySignup.js"],"sourcesContent":["import { ROLES } from '../models/Role'\r\nimport User from '../models/User'\r\n\r\nexport const checkDuplicateUsernameOrEmail = async(req, res, next) => {\r\n    const user = await User.findOne({ username: req.body.username });\r\n    if (user) return res.status(400).json({ message: 'El usuario ya existe' });\r\n\r\n    const email = await User.findOne({ email: req.body.email });\r\n    if (email) return res.status(400).json({ message: 'El email ya existe' });\r\n\r\n    next();\r\n}\r\n\r\nexport const checkRolesExist = (req, res, next) => {\r\n    //console.log(req.body.roles)\r\n    if (req.body.roles) {\r\n        for (let h = 0; h < req.body.roles.size; h++) {\r\n            if (!ROLES.includes(req.body.roles[h])) {\r\n                return res.status(400).json({ message: `Rol ${req.body.roles[h]} no existe` });\r\n            }\r\n        }\r\n    }\r\n    next();\r\n}"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;+CAAA,oJ;;AAEO,IAAMA,6BAA6B;EAAA,oFAAG,iBAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OACtBC,aAAA,CAAKC,OAAL,CAAa;cAAEC,QAAQ,EAAEL,GAAG,CAACM,IAAJ,CAASD;YAArB,CAAb,CADsB;;UAAA;YACnCE,IADmC;;YAAA,KAErCA,IAFqC;cAAA;cAAA;YAAA;;YAAA,iCAExBN,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAAEC,OAAO,EAAE;YAAX,CAArB,CAFwB;;UAAA;YAAA;YAAA,OAIrBP,aAAA,CAAKC,OAAL,CAAa;cAAEO,KAAK,EAAEX,GAAG,CAACM,IAAJ,CAASK;YAAlB,CAAb,CAJqB;;UAAA;YAInCA,KAJmC;;YAAA,KAKrCA,KALqC;cAAA;cAAA;YAAA;;YAAA,iCAKvBV,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;cAAEC,OAAO,EAAE;YAAX,CAArB,CALuB;;UAAA;YAOzCR,IAAI;;UAPqC;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAH;;EAAA,gBAA7BH,6BAA6B;IAAA;EAAA;AAAA,GAAnC;;;;AAUA,IAAMa,eAAe,GAAG,SAAlBA,eAAkB,CAACZ,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;EAC/C;EACA,IAAIF,GAAG,CAACM,IAAJ,CAASO,KAAb,EAAoB;IAChB,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,GAAG,CAACM,IAAJ,CAASO,KAAT,CAAeE,IAAnC,EAAyCD,CAAC,EAA1C,EAA8C;MAC1C,IAAI,CAACE,WAAA,CAAMC,QAAN,CAAejB,GAAG,CAACM,IAAJ,CAASO,KAAT,CAAeC,CAAf,CAAf,CAAL,EAAwC;QACpC,OAAOb,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;UAAEC,OAAO,gBAASV,GAAG,CAACM,IAAJ,CAASO,KAAT,CAAeC,CAAf,CAAT;QAAT,CAArB,CAAP;MACH;IACJ;EACJ;;EACDZ,IAAI;AACP,CAVM"}