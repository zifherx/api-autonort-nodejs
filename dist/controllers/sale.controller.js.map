{"version":3,"sources":["../../src/controllers/sale.controller.js"],"names":["createSale","req","res","body","vendedor","cliente","auto","serie_tdp","color","precio","anio_fabricacion","anio_modelo","ubicacion_vehiculo","fecha_ciguena","fecha_entrega","estatus_vehiculo","tipo_financiamiento","entidad_bancaria","sustento","fecha_sustento","monto_aprobado","oficina","ejecutivo","montoAdelanto1","fechaAdelanto1","montoAdelanto2","fechaAdelanto2","montoAdelanto3","fechaAdelanto3","montoAdelanto4","fechaAdelanto4","montoAdelanto5","fechaAdelanto5","montoAdelanto6","fechaAdelanto6","montoAdelanto7","fechaAdelanto7","montoAdelanto8","fechaAdelanto8","campanias","adicional","descuento_autonort","observacion_adv","accesorios","condicion_accesorios","fecha_facturacion_tdp","estatus_facturacion","tipo_operacion","fecha_inicio_reserva","fecha_fin_reserva","tipo_comprobante","nro_comprobante","fecha_comprobante","estatus_venta","sucursal_venta","fecha_cancelacion","empleado","newSale","Sale","Seller","find","name","$in","foundSeller","map","seller","_id","Vehicle","cod_tdp","foundVehicle","vehicle","Customer","document","foundCustomer","customer","Campaign","foundCampaign","campaign","Adicional","foundAdicional","Props","foundProps","props","User","username","foundEmployee","em","save","saleSaved","json","message","console","log","status","getSales","populate","ventasfull","length","getSaleById","salesId","params","findById","path","select","query","expediente","updateSaleById","monto_facturado","findByIdAndUpdate","ventaActualizada","deleteSaleById","findByIdAndDelete","deleteSale","UnidadesLibres","estado","tramite","pasoaTramite","total","files","UnidadesByStatus","sucursal","sort","UnidadesBySucursal","start","end","$gte","Date","$lte","conteoUnidadesCanceladas","where","countDocuments","consulta","conteoUnidadesLibres","conteonidadesBySucursalFecha","count","conteoUnidadesBySucursalStatusFecha","conteoVentasByVendedor","estatus","filter","aggregate","$match","$group","num_ventas","$sum","conteoVentasByModelo","vistaUnidadesEntregadasByStatus","obtenerToyotaValues","statusVenta","objetos","forEach","element","perra","serie","vehiculo","push","nro_adicionales","toyota_values"],"mappings":"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","sourcesContent":["import Sale from '../models/Sale'\r\nimport Vehicle from '../models/Vehicle'\r\nimport Seller from '../models/Seller'\r\nimport Customer from '../models/Customer'\r\nimport Campaign from '../models/Campaign'\r\nimport Adicional from '../models/Adicional'\r\nimport Props from '../models/Props'\r\nimport User from '../models/User'\r\nimport { restart } from 'nodemon'\r\n\r\nexport const createSale = async(req, res) => {\r\n    const {\r\n        vendedor,\r\n        cliente,\r\n        auto,\r\n        serie_tdp,\r\n        color,\r\n        precio,\r\n        anio_fabricacion,\r\n        anio_modelo,\r\n        ubicacion_vehiculo,\r\n        fecha_ciguena,\r\n        fecha_entrega,\r\n        estatus_vehiculo,\r\n        tipo_financiamiento,\r\n        entidad_bancaria,\r\n        sustento,\r\n        fecha_sustento,\r\n        monto_aprobado,\r\n        oficina,\r\n        ejecutivo,\r\n        montoAdelanto1,\r\n        fechaAdelanto1,\r\n        montoAdelanto2,\r\n        fechaAdelanto2,\r\n        montoAdelanto3,\r\n        fechaAdelanto3,\r\n        montoAdelanto4,\r\n        fechaAdelanto4,\r\n        montoAdelanto5,\r\n        fechaAdelanto5,\r\n        montoAdelanto6,\r\n        fechaAdelanto6,\r\n        montoAdelanto7,\r\n        fechaAdelanto7,\r\n        montoAdelanto8,\r\n        fechaAdelanto8,\r\n        campanias,\r\n        adicional,\r\n        descuento_autonort,\r\n        observacion_adv,\r\n        accesorios,\r\n        condicion_accesorios,\r\n        fecha_facturacion_tdp,\r\n        estatus_facturacion,\r\n        tipo_operacion,\r\n        fecha_inicio_reserva,\r\n        fecha_fin_reserva,\r\n        tipo_comprobante,\r\n        nro_comprobante,\r\n        fecha_comprobante,\r\n        estatus_venta,\r\n        sucursal_venta,\r\n        fecha_cancelacion,\r\n        empleado\r\n    } = req.body;\r\n\r\n    try {\r\n\r\n        const newSale = new Sale({ serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, fecha_ciguena, fecha_entrega, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, descuento_autonort, observacion_adv, condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion });\r\n\r\n        //Seller\r\n        const foundSeller = await Seller.find({ name: { $in: vendedor } });\r\n        newSale.vendedor = foundSeller.map(seller => seller._id);\r\n\r\n        //Vehicle\r\n        const foundVehicle = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n        newSale.auto = foundVehicle.map(vehicle => vehicle._id);\r\n\r\n        //Customer\r\n        const foundCustomer = await Customer.find({ document: { $in: cliente } });\r\n        newSale.cliente = foundCustomer.map(customer => customer._id);\r\n\r\n        //Campaign\r\n        const foundCampaign = await Campaign.find({ name: { $in: campanias } });\r\n        newSale.campanias = foundCampaign.map(campaign => campaign._id);\r\n\r\n        //Adicional\r\n        const foundAdicional = await Adicional.find({ name: { $in: adicional } });\r\n        newSale.adicional = foundAdicional.map(adicional => adicional._id);\r\n\r\n        //Props\r\n        const foundProps = await Props.find({ name: { $in: accesorios } });\r\n        newSale.accesorios = foundProps.map(props => props._id);\r\n\r\n        //Empleado\r\n        const foundEmployee = await User.find({ username: { $in: empleado } });\r\n        newSale.empleado = foundEmployee.map(em => em._id);\r\n\r\n        //console.log(newSale);\r\n        const saleSaved = await newSale.save();\r\n        if (saleSaved) {\r\n            res.json({ message: 'Expediente creado con éxito' });\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const getSales = async(req, res) => {\r\n    try {\r\n        const ventasfull = await Sale.find()\r\n            .populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('adicional')\r\n            .populate('accesorios')\r\n            .populate('empleado');\r\n\r\n        if (ventasfull.length > 0) {\r\n            res.json(ventasfull);\r\n        } else {\r\n            return res.status(404).json({ message: 'No Existen Expedientes' })\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const getSaleById = async(req, res) => {\r\n    const { salesId } = req.params;\r\n\r\n    try {\r\n\r\n        const query = await Sale.findById(salesId)\r\n            .populate({ path: 'vendedor', select: 'name sucursal' })\r\n            .populate({\r\n                path: 'auto',\r\n                select: 'model version cod_tdp',\r\n                populate: {\r\n                    path: 'model',\r\n                    select: 'marca name avatar',\r\n                    populate: { path: 'marca', select: 'name avatar' }\r\n                },\r\n            })\r\n            .populate({ path: 'cliente', select: 'name document' })\r\n            .populate('campanias')\r\n            .populate('adicional')\r\n            .populate('accesorios')\r\n            .populate({ path: 'empleado', select: 'name username' });\r\n\r\n        if (query) {\r\n            res.json({ expediente: query });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe el Expediente' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const updateSaleById = async(req, res) => {\r\n    const { salesId } = req.params;\r\n\r\n    const { vendedor, cliente, auto, serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, fecha_ciguena, fecha_entrega, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, campanias, adicional, descuento_autonort, observacion_adv, accesorios, condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, monto_facturado, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion } = req.body;\r\n\r\n    try {\r\n\r\n        //Seller\r\n        const foundSeller = await Seller.find({ name: { $in: vendedor } });\r\n\r\n        //Vehicle\r\n        const foundVehicle = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n\r\n        //Customer\r\n        const foundCustomer = await Customer.find({ document: { $in: cliente } });\r\n\r\n        //Campaign\r\n        const foundCampaign = await Campaign.find({ name: { $in: campanias } });\r\n\r\n        //Adicional\r\n        const foundAdicional = await Adicional.find({ name: { $in: adicional } });\r\n\r\n        //Props\r\n        const foundProps = await Props.find({ name: { $in: accesorios } });\r\n\r\n        const ventaActualizada = await Sale.findByIdAndUpdate(salesId, {\r\n            vendedor: foundSeller.map(seller => seller._id),\r\n            cliente: foundCustomer.map(customer => customer._id),\r\n            auto: foundVehicle.map(vehicle => vehicle._id),\r\n            serie_tdp,\r\n            color,\r\n            precio,\r\n            anio_fabricacion,\r\n            anio_modelo,\r\n            ubicacion_vehiculo,\r\n            fecha_ciguena,\r\n            fecha_entrega,\r\n            estatus_vehiculo,\r\n            tipo_financiamiento,\r\n            entidad_bancaria,\r\n            sustento,\r\n            fecha_sustento,\r\n            monto_aprobado,\r\n            oficina,\r\n            ejecutivo,\r\n            montoAdelanto1,\r\n            fechaAdelanto1,\r\n            montoAdelanto2,\r\n            fechaAdelanto2,\r\n            montoAdelanto3,\r\n            fechaAdelanto3,\r\n            montoAdelanto4,\r\n            fechaAdelanto4,\r\n            montoAdelanto5,\r\n            fechaAdelanto5,\r\n            montoAdelanto6,\r\n            fechaAdelanto6,\r\n            montoAdelanto7,\r\n            fechaAdelanto7,\r\n            montoAdelanto8,\r\n            fechaAdelanto8,\r\n            campanias: foundCampaign.map(campaign => campaign._id),\r\n            adicional: foundAdicional.map(adicional => adicional._id),\r\n            descuento_autonort,\r\n            observacion_adv,\r\n            accesorios: foundProps.map(props => props._id),\r\n            condicion_accesorios,\r\n            fecha_facturacion_tdp,\r\n            estatus_facturacion,\r\n            monto_facturado,\r\n            tipo_operacion,\r\n            fecha_inicio_reserva,\r\n            fecha_fin_reserva,\r\n            tipo_comprobante,\r\n            nro_comprobante,\r\n            fecha_comprobante,\r\n            estatus_venta,\r\n            sucursal_venta,\r\n            fecha_cancelacion\r\n        });\r\n\r\n        if (ventaActualizada) {\r\n            res.json({ message: 'Expediente actualizado con éxito' });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe Expediente a actualizar' });\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const deleteSaleById = async(req, res) => {\r\n    const { salesId } = req.params;\r\n\r\n    try {\r\n        const deleteSale = await Sale.findByIdAndDelete(salesId);\r\n\r\n        if (deleteSale) {\r\n            res.json({ message: 'Expediente eliminado con éxito' });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe Expediente a eliminar' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const UnidadesLibres = async(req, res) => {\r\n    const { estado, tramite } = req.body;\r\n    try {\r\n        const query = await Sale.find({ estatus_venta: estado, pasoaTramite: tramite })\r\n            .populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('adicional')\r\n            .populate('accesorios')\r\n            .populate('empleado')\r\n        if (query.length > 0) {\r\n            res.json({ total: query.length, files: query });\r\n        } else {\r\n            return res.status(404).json({ message: `No existen Unidades ${estado}` })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message });\r\n    }\r\n}\r\n\r\nexport const UnidadesByStatus = async(req, res) => {\r\n    const { estado, tramite, sucursal } = req.body;\r\n    try {\r\n        const query = await Sale.find({ estatus_venta: estado, pasoaTramite: tramite, sucursal_venta: sucursal }).sort({ fecha_cancelacion: 'desc' })\r\n            .populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('adicional')\r\n            .populate('accesorios')\r\n            .populate('empleado')\r\n        if (query.length > 0) {\r\n            res.json({ total: query.length, files: query });\r\n        } else {\r\n            return res.status(404).json({ message: `No existen Unidades ${estado}` })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const UnidadesBySucursal = async(req, res) => {\r\n    const { sucursal, start, end } = req.body;\r\n    try {\r\n        const query = await Sale.find({ sucursal_venta: sucursal, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } })\r\n            .sort({ fecha_cancelacion: 'desc' })\r\n            .populate({ path: 'vendedor', select: 'name sucursal' })\r\n            .populate({\r\n                path: 'auto',\r\n                select: 'cod_tdp model version',\r\n                populate: {\r\n                    path: 'model',\r\n                    select: 'avatar name marca',\r\n                    populate: {\r\n                        path: 'marca',\r\n                        select: 'avatar name'\r\n                    }\r\n                }\r\n            })\r\n            .populate({ path: 'cliente', select: 'name document cellphone' })\r\n            .populate({ path: 'campanias' })\r\n            .populate({ path: 'adicional' })\r\n            .populate({ path: 'accesorios' })\r\n            .populate({ path: 'empleado', select: 'username name' })\r\n        if (query.length > 0) {\r\n            res.json({ total: query.length, files: query });\r\n        } else {\r\n            return res.status(404).json({ message: 'No Existen Unidades' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesCanceladas = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Cancelado' }).countDocuments();\r\n        //console.log(consulta)\r\n        if (consulta >= 0) {\r\n            res.json(consulta);\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesLibres = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Libre' }).countDocuments();\r\n        if (consulta >= 0) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(404).json({ message: 'No existen Unidades Libres' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const conteonidadesBySucursalFecha = async(req, res) => {\r\n    const { sucursal, start, end } = req.body;\r\n    try {\r\n        const query = await Sale.find({ sucursal_venta: sucursal, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } }).countDocuments();\r\n        if (query >= 0) {\r\n            res.json({ count: query });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existen unidades' });\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message });\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesBySucursalStatusFecha = async(req, res) => {\r\n    const { sucursal, status, start, end } = req.body;\r\n    //console.log(start, end);\r\n    try {\r\n        const query = await Sale.find({ sucursal_venta: sucursal, estatus_venta: status, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } }).countDocuments();\r\n        //console.log('Query: ', query);\r\n        if (query >= 0) {\r\n            res.json({ count: query });\r\n        } else {\r\n            return res.status(404).json({ message: `No existen Unidades ${status} en ${sucursal}` })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const conteoVentasByVendedor = async(req, res) => {\r\n    const { sucursal, estatus, start, end } = req.body;\r\n    // console.log(req.body)\r\n    try {\r\n        const filter = { sucursal_venta: sucursal, estatus_venta: estatus, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } };\r\n        const consulta = await Sale.aggregate([{\r\n            $match: filter\r\n        }, {\r\n            $group: {\r\n                _id: \"$vendedor\",\r\n                num_ventas: { $sum: 1 }\r\n            }\r\n        }]);\r\n        if (consulta.length > 0) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Ventas aún' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const conteoVentasByModelo = async(req, res) => {\r\n    const { sucursal, estatus, start, end } = req.body;\r\n    try {\r\n        const filter = { sucursal_venta: sucursal, estatus_venta: estatus, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } };\r\n        const consulta = await Sale.aggregate([{\r\n            $match: filter\r\n        }, {\r\n            $group: {\r\n                _id: \"$auto\",\r\n                num_ventas: { $sum: 1 }\r\n            }\r\n        }]);\r\n        if (consulta.length > 0) {\r\n            res.json(consulta);\r\n        } else {\r\n            res.status(404).json({ message: 'No existen Ventas aún' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message });\r\n    }\r\n}\r\n\r\nexport const vistaUnidadesEntregadasByStatus = async(req, res) => {\r\n    const { sucursal, start, end } = req.body;\r\n    try {\r\n        const query = await Sale.where({ sucursal_venta: sucursal, fecha_entrega: { $gte: new Date(start), $lte: new Date(end) } }).find().countDocuments();\r\n        if (query >= 0) {\r\n            res.json({ total: query });\r\n        } else {\r\n            return res.status(404).json({ message: `No existen Unidades entregadas en ${sucursal}` })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const obtenerToyotaValues = async(req, res) => {\r\n    const { sucursal, statusVenta, start, end } = req.body;\r\n    const objetos = []\r\n    try {\r\n        // const query = await Sale.where({ sucursal_venta: sucursal, estatus_venta: statusVenta, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) }, adicional: { $gte: 1 } }).find();\r\n        const query = await Sale.where({ sucursal_venta: sucursal, estatus_venta: statusVenta, fecha_cancelacion: { $gte: new Date(start), $lte: new Date(end) } }).find().populate('adicional vendedor auto')\r\n            // const values = await query.adicional\r\n            // console.log(query)\r\n        query.forEach((element) => {\r\n            console.log(element)\r\n            if (element.adicional.length > 0) {\r\n                let perra = {};\r\n                perra.sucursal = element.sucursal_venta\r\n                perra.serie = element.serie_tdp\r\n                perra.adicional = element.adicional\r\n                perra.vendedor = element.vendedor\r\n                perra.vehiculo = element.auto\r\n                objetos.push(perra)\r\n            }\r\n        })\r\n        if (query >= 0) {\r\n\r\n            res.json({ nro_adicionales: objetos.length, toyota_values: objetos })\r\n        } else {\r\n            return res.status(404).json({ message: `No existen Unidades ${statusVenta} en ${sucursal} con Toyota Value en ese rango de fechas` })\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(err.message)\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}"],"file":"sale.controller.js"}