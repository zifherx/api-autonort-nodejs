{"version":3,"sources":["../../src/controllers/sale.controller.js"],"names":["createSale","req","res","body","vendedor","cliente","auto","serie_tdp","color","precio","anio_fabricacion","anio_modelo","ubicacion_vehiculo","estatus_vehiculo","tipo_financiamiento","entidad_bancaria","sustento","fecha_sustento","monto_aprobado","oficina","ejecutivo","montoAdelanto1","fechaAdelanto1","montoAdelanto2","fechaAdelanto2","montoAdelanto3","fechaAdelanto3","montoAdelanto4","fechaAdelanto4","montoAdelanto5","fechaAdelanto5","montoAdelanto6","fechaAdelanto6","montoAdelanto7","fechaAdelanto7","montoAdelanto8","fechaAdelanto8","campanias","descuento_autonort","observacion_adv","accesorios","condicion_accesorios","fecha_facturacion_tdp","estatus_facturacion","tipo_operacion","fecha_inicio_reserva","fecha_fin_reserva","tipo_comprobante","nro_comprobante","fecha_comprobante","estatus_venta","sucursal_venta","fecha_cancelacion","newSale","Sale","Seller","find","name","$in","foundSeller","map","seller","_id","Vehicle","cod_tdp","foundVehicle","vehicle","Customer","document","foundCustomer","customer","Campaign","foundCampaign","campaign","Props","foundProps","props","save","saleSaved","json","message","console","log","status","getSales","populate","ventasfull","length","getSaleById","salesId","params","findById","venta","send","updateSaleById","findByIdAndUpdate","ventaActualizada","deleteSaleById","findByIdAndDelete","deleteSale","UnidadesByStatus","estado","where","query","UnidadesBySucursal","sucursal","conteoUnidadesCanceladas","countDocuments","consulta","error","conteoUnidadesLibres","conteoTarapotoCanceladas","conteoJaenCanceladas","conteoTarapotoLibres","conteoJaenLibres","conteoUnidadesAnticipos","conteoTarapotoAnticipos","conteoJaenAnticipos","conteoVentasByVendedor","aggregate","$unwind","$group","num_ventas","$sum"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEO,IAAMA,UAAU;AAAA,qFAAG,iBAAMC,GAAN,EAAWC,GAAX;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAEqvBD,GAAG,CAACE,IAFzvB,EAEVC,QAFU,aAEVA,QAFU,EAEAC,OAFA,aAEAA,OAFA,EAESC,IAFT,aAESA,IAFT,EAEeC,SAFf,aAEeA,SAFf,EAE0BC,KAF1B,aAE0BA,KAF1B,EAEiCC,MAFjC,aAEiCA,MAFjC,EAEyCC,gBAFzC,aAEyCA,gBAFzC,EAE2DC,WAF3D,aAE2DA,WAF3D,EAEwEC,kBAFxE,aAEwEA,kBAFxE,EAE4FC,gBAF5F,aAE4FA,gBAF5F,EAE8GC,mBAF9G,aAE8GA,mBAF9G,EAEmIC,gBAFnI,aAEmIA,gBAFnI,EAEqJC,QAFrJ,aAEqJA,QAFrJ,EAE+JC,cAF/J,aAE+JA,cAF/J,EAE+KC,cAF/K,aAE+KA,cAF/K,EAE+LC,OAF/L,aAE+LA,OAF/L,EAEwMC,SAFxM,aAEwMA,SAFxM,EAEmNC,cAFnN,aAEmNA,cAFnN,EAEmOC,cAFnO,aAEmOA,cAFnO,EAEmPC,cAFnP,aAEmPA,cAFnP,EAEmQC,cAFnQ,aAEmQA,cAFnQ,EAEmRC,cAFnR,aAEmRA,cAFnR,EAEmSC,cAFnS,aAEmSA,cAFnS,EAEmTC,cAFnT,aAEmTA,cAFnT,EAEmUC,cAFnU,aAEmUA,cAFnU,EAEmVC,cAFnV,aAEmVA,cAFnV,EAEmWC,cAFnW,aAEmWA,cAFnW,EAEmXC,cAFnX,aAEmXA,cAFnX,EAEmYC,cAFnY,aAEmYA,cAFnY,EAEmZC,cAFnZ,aAEmZA,cAFnZ,EAEmaC,cAFna,aAEmaA,cAFna,EAEmbC,cAFnb,aAEmbA,cAFnb,EAEmcC,cAFnc,aAEmcA,cAFnc,EAEmdC,SAFnd,aAEmdA,SAFnd,EAE8dC,kBAF9d,aAE8dA,kBAF9d,EAEkfC,eAFlf,aAEkfA,eAFlf,EAEmgBC,UAFngB,aAEmgBA,UAFngB,EAE+gBC,oBAF/gB,aAE+gBA,oBAF/gB,EAEqiBC,qBAFriB,aAEqiBA,qBAFriB,EAE4jBC,mBAF5jB,aAE4jBA,mBAF5jB,EAEilBC,cAFjlB,aAEilBA,cAFjlB,EAEimBC,oBAFjmB,aAEimBA,oBAFjmB,EAEunBC,iBAFvnB,aAEunBA,iBAFvnB,EAE0oBC,gBAF1oB,aAE0oBA,gBAF1oB,EAE4pBC,eAF5pB,aAE4pBA,eAF5pB,EAE6qBC,iBAF7qB,aAE6qBA,iBAF7qB,EAEgsBC,aAFhsB,aAEgsBA,aAFhsB,EAE+sBC,cAF/sB,aAE+sBA,cAF/sB,EAE+tBC,iBAF/tB,aAE+tBA,iBAF/tB;AAIZC,YAAAA,OAJY,GAIF,IAAIC,aAAJ,CAAS;AAAE/C,cAAAA,SAAS,EAATA,SAAF;AAAaC,cAAAA,KAAK,EAALA,KAAb;AAAoBC,cAAAA,MAAM,EAANA,MAApB;AAA4BC,cAAAA,gBAAgB,EAAhBA,gBAA5B;AAA8CC,cAAAA,WAAW,EAAXA,WAA9C;AAA2DC,cAAAA,kBAAkB,EAAlBA,kBAA3D;AAA+EC,cAAAA,gBAAgB,EAAhBA,gBAA/E;AAAiGC,cAAAA,mBAAmB,EAAnBA,mBAAjG;AAAsHC,cAAAA,gBAAgB,EAAhBA,gBAAtH;AAAwIC,cAAAA,QAAQ,EAARA,QAAxI;AAAkJC,cAAAA,cAAc,EAAdA,cAAlJ;AAAkKC,cAAAA,cAAc,EAAdA,cAAlK;AAAkLC,cAAAA,OAAO,EAAPA,OAAlL;AAA2LC,cAAAA,SAAS,EAATA,SAA3L;AAAsMC,cAAAA,cAAc,EAAdA,cAAtM;AAAsNC,cAAAA,cAAc,EAAdA,cAAtN;AAAsOC,cAAAA,cAAc,EAAdA,cAAtO;AAAsPC,cAAAA,cAAc,EAAdA,cAAtP;AAAsQC,cAAAA,cAAc,EAAdA,cAAtQ;AAAsRC,cAAAA,cAAc,EAAdA,cAAtR;AAAsSC,cAAAA,cAAc,EAAdA,cAAtS;AAAsTC,cAAAA,cAAc,EAAdA,cAAtT;AAAsUC,cAAAA,cAAc,EAAdA,cAAtU;AAAsVC,cAAAA,cAAc,EAAdA,cAAtV;AAAsWC,cAAAA,cAAc,EAAdA,cAAtW;AAAsXC,cAAAA,cAAc,EAAdA,cAAtX;AAAsYC,cAAAA,cAAc,EAAdA,cAAtY;AAAsZC,cAAAA,cAAc,EAAdA,cAAtZ;AAAsaC,cAAAA,cAAc,EAAdA,cAAta;AAAsbC,cAAAA,cAAc,EAAdA,cAAtb;AAAscE,cAAAA,kBAAkB,EAAlBA,kBAAtc;AAA0dC,cAAAA,eAAe,EAAfA,eAA1d;AAA2eE,cAAAA,oBAAoB,EAApBA,oBAA3e;AAAigBC,cAAAA,qBAAqB,EAArBA,qBAAjgB;AAAwhBC,cAAAA,mBAAmB,EAAnBA,mBAAxhB;AAA6iBC,cAAAA,cAAc,EAAdA,cAA7iB;AAA6jBC,cAAAA,oBAAoB,EAApBA,oBAA7jB;AAAmlBC,cAAAA,iBAAiB,EAAjBA,iBAAnlB;AAAsmBC,cAAAA,gBAAgB,EAAhBA,gBAAtmB;AAAwnBC,cAAAA,eAAe,EAAfA,eAAxnB;AAAyoBC,cAAAA,iBAAiB,EAAjBA,iBAAzoB;AAA4pBC,cAAAA,aAAa,EAAbA,aAA5pB;AAA2qBC,cAAAA,cAAc,EAAdA,cAA3qB;AAA2rBC,cAAAA,iBAAiB,EAAjBA;AAA3rB,aAAT,CAJE,EAMlB;;AANkB;AAAA,mBAOQG,gBAAOC,IAAP,CAAY;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAEtD;AAAP;AAAR,aAAZ,CAPR;;AAAA;AAOZuD,YAAAA,WAPY;AAQlBN,YAAAA,OAAO,CAACjD,QAAR,GAAmBuD,WAAW,CAACC,GAAZ,CAAgB,UAAAC,MAAM;AAAA,qBAAIA,MAAM,CAACC,GAAX;AAAA,aAAtB,CAAnB,CARkB,CAUlB;;AAVkB;AAAA,mBAWSC,iBAAQP,IAAR,CAAa;AAAEQ,cAAAA,OAAO,EAAE;AAAEN,gBAAAA,GAAG,EAAEpD;AAAP;AAAX,aAAb,CAXT;;AAAA;AAWZ2D,YAAAA,YAXY;AAYlBZ,YAAAA,OAAO,CAAC/C,IAAR,GAAe2D,YAAY,CAACL,GAAb,CAAiB,UAAAM,OAAO;AAAA,qBAAIA,OAAO,CAACJ,GAAZ;AAAA,aAAxB,CAAf,CAZkB,CAclB;;AAdkB;AAAA,mBAeUK,kBAASX,IAAT,CAAc;AAAEY,cAAAA,QAAQ,EAAE;AAAEV,gBAAAA,GAAG,EAAErD;AAAP;AAAZ,aAAd,CAfV;;AAAA;AAeZgE,YAAAA,aAfY;AAgBlBhB,YAAAA,OAAO,CAAChD,OAAR,GAAkBgE,aAAa,CAACT,GAAd,CAAkB,UAAAU,QAAQ;AAAA,qBAAIA,QAAQ,CAACR,GAAb;AAAA,aAA1B,CAAlB,CAhBkB,CAkBlB;;AAlBkB;AAAA,mBAmBUS,kBAASf,IAAT,CAAc;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAErB;AAAP;AAAR,aAAd,CAnBV;;AAAA;AAmBZmC,YAAAA,aAnBY;AAoBlBnB,YAAAA,OAAO,CAAChB,SAAR,GAAoBmC,aAAa,CAACZ,GAAd,CAAkB,UAAAa,QAAQ;AAAA,qBAAIA,QAAQ,CAACX,GAAb;AAAA,aAA1B,CAApB,CApBkB,CAsBlB;;AAtBkB;AAAA,mBAuBOY,eAAMlB,IAAN,CAAW;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAElB;AAAP;AAAR,aAAX,CAvBP;;AAAA;AAuBZmC,YAAAA,UAvBY;AAwBlBtB,YAAAA,OAAO,CAACb,UAAR,GAAqBmC,UAAU,CAACf,GAAX,CAAe,UAAAgB,KAAK;AAAA,qBAAIA,KAAK,CAACd,GAAV;AAAA,aAApB,CAArB,CAxBkB,CA0BlB;;AA1BkB;AAAA,mBA2BMT,OAAO,CAACwB,IAAR,EA3BN;;AAAA;AA2BZC,YAAAA,SA3BY;;AA4BlB,gBAAIA,SAAJ,EAAe;AACX5E,cAAAA,GAAG,CAAC6E,IAAJ,CAAS;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAAT;AACH;;AA9BiB;AAAA;;AAAA;AAAA;AAAA;AAgClBC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAjCkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVhF,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;AAqCA,IAAMoF,QAAQ;AAAA,sFAAG,kBAAMnF,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAESoD,cAAKE,IAAL,GACpB6B,QADoB,CACX,UADW,EAEpBA,QAFoB,CAEX,MAFW,EAGpBA,QAHoB,CAGX,SAHW,EAIpBA,QAJoB,CAIX,WAJW,EAKpBA,QALoB,CAKX,YALW,CAFT;;AAAA;AAEVC,YAAAA,UAFU;;AAAA,kBASZA,UAAU,CAACC,MAAX,GAAoB,CATR;AAAA;AAAA;AAAA;;AAUZrF,YAAAA,GAAG,CAAC6E,IAAJ,CAASO,UAAT;AAVY;AAAA;;AAAA;AAAA,8CAYLpF,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CAZK;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAgBhBC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAAC6E,IAAJ,CAAS;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAAT;;AAjBgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAARI,QAAQ;AAAA;AAAA;AAAA,GAAd;;;;AAqBA,IAAMI,WAAW;AAAA,sFAAG,kBAAMvF,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEXuF,YAAAA,OAFW,GAECxF,GAAG,CAACyF,MAFL,CAEXD,OAFW;AAAA;AAAA,mBAGCnC,cAAKqC,QAAL,CAAcF,OAAd,EACfJ,QADe,CACN,UADM,EAEfA,QAFe,CAEN,MAFM,EAGfA,QAHe,CAGN,SAHM,EAIfA,QAJe,CAIN,WAJM,EAKfA,QALe,CAKN,YALM,CAHD;;AAAA;AAGbO,YAAAA,KAHa;;AAUnB,gBAAIA,KAAJ,EAAW;AACP1F,cAAAA,GAAG,CAAC2F,IAAJ,CAASD,KAAT;AACH;;AAZkB;AAAA;;AAAA;AAAA;AAAA;AAcnBX,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAfmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAXQ,WAAW;AAAA;AAAA;AAAA,GAAjB;;;;AAmBA,IAAMM,cAAc;AAAA,sFAAG,kBAAM7F,GAAN,EAAWC,GAAX;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEduF,YAAAA,OAFc,GAEFxF,GAAG,CAACyF,MAFF,CAEdD,OAFc;AAAA,yBAIivBxF,GAAG,CAACE,IAJrvB,EAIdC,QAJc,cAIdA,QAJc,EAIJC,OAJI,cAIJA,OAJI,EAIKC,IAJL,cAIKA,IAJL,EAIWC,SAJX,cAIWA,SAJX,EAIsBC,KAJtB,cAIsBA,KAJtB,EAI6BC,MAJ7B,cAI6BA,MAJ7B,EAIqCC,gBAJrC,cAIqCA,gBAJrC,EAIuDC,WAJvD,cAIuDA,WAJvD,EAIoEC,kBAJpE,cAIoEA,kBAJpE,EAIwFC,gBAJxF,cAIwFA,gBAJxF,EAI0GC,mBAJ1G,cAI0GA,mBAJ1G,EAI+HC,gBAJ/H,cAI+HA,gBAJ/H,EAIiJC,QAJjJ,cAIiJA,QAJjJ,EAI2JC,cAJ3J,cAI2JA,cAJ3J,EAI2KC,cAJ3K,cAI2KA,cAJ3K,EAI2LC,OAJ3L,cAI2LA,OAJ3L,EAIoMC,SAJpM,cAIoMA,SAJpM,EAI+MC,cAJ/M,cAI+MA,cAJ/M,EAI+NC,cAJ/N,cAI+NA,cAJ/N,EAI+OC,cAJ/O,cAI+OA,cAJ/O,EAI+PC,cAJ/P,cAI+PA,cAJ/P,EAI+QC,cAJ/Q,cAI+QA,cAJ/Q,EAI+RC,cAJ/R,cAI+RA,cAJ/R,EAI+SC,cAJ/S,cAI+SA,cAJ/S,EAI+TC,cAJ/T,cAI+TA,cAJ/T,EAI+UC,cAJ/U,cAI+UA,cAJ/U,EAI+VC,cAJ/V,cAI+VA,cAJ/V,EAI+WC,cAJ/W,cAI+WA,cAJ/W,EAI+XC,cAJ/X,cAI+XA,cAJ/X,EAI+YC,cAJ/Y,cAI+YA,cAJ/Y,EAI+ZC,cAJ/Z,cAI+ZA,cAJ/Z,EAI+aC,cAJ/a,cAI+aA,cAJ/a,EAI+bC,cAJ/b,cAI+bA,cAJ/b,EAI+cC,SAJ/c,cAI+cA,SAJ/c,EAI0dC,kBAJ1d,cAI0dA,kBAJ1d,EAI8eC,eAJ9e,cAI8eA,eAJ9e,EAI+fC,UAJ/f,cAI+fA,UAJ/f,EAI2gBC,oBAJ3gB,cAI2gBA,oBAJ3gB,EAIiiBC,qBAJjiB,cAIiiBA,qBAJjiB,EAIwjBC,mBAJxjB,cAIwjBA,mBAJxjB,EAI6kBC,cAJ7kB,cAI6kBA,cAJ7kB,EAI6lBC,oBAJ7lB,cAI6lBA,oBAJ7lB,EAImnBC,iBAJnnB,cAImnBA,iBAJnnB,EAIsoBC,gBAJtoB,cAIsoBA,gBAJtoB,EAIwpBC,eAJxpB,cAIwpBA,eAJxpB,EAIyqBC,iBAJzqB,cAIyqBA,iBAJzqB,EAI4rBC,aAJ5rB,cAI4rBA,aAJ5rB,EAI2sBC,cAJ3sB,cAI2sBA,cAJ3sB,EAI2tBC,iBAJ3tB,cAI2tBA,iBAJ3tB,EAMtB;;AANsB;AAAA,mBAOIG,gBAAOC,IAAP,CAAY;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAEtD;AAAP;AAAR,aAAZ,CAPJ;;AAAA;AAOhBuD,YAAAA,WAPgB;AAAA;AAAA,mBAUKI,iBAAQP,IAAR,CAAa;AAAEQ,cAAAA,OAAO,EAAE;AAAEN,gBAAAA,GAAG,EAAEpD;AAAP;AAAX,aAAb,CAVL;;AAAA;AAUhB2D,YAAAA,YAVgB;AAAA;AAAA,mBAaME,kBAASX,IAAT,CAAc;AAAEY,cAAAA,QAAQ,EAAE;AAAEV,gBAAAA,GAAG,EAAErD;AAAP;AAAZ,aAAd,CAbN;;AAAA;AAahBgE,YAAAA,aAbgB;AAAA;AAAA,mBAgBME,kBAASf,IAAT,CAAc;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAErB;AAAP;AAAR,aAAd,CAhBN;;AAAA;AAgBhBmC,YAAAA,aAhBgB;AAAA;AAAA,mBAmBGE,eAAMlB,IAAN,CAAW;AAAEC,cAAAA,IAAI,EAAE;AAAEC,gBAAAA,GAAG,EAAElB;AAAP;AAAR,aAAX,CAnBH;;AAAA;AAmBhBmC,YAAAA,UAnBgB;AAAA;AAAA,mBAqBSrB,cAAKyC,iBAAL,CAAuBN,OAAvB,EAAgC;AAAErF,cAAAA,QAAQ,EAAEuD,WAAW,CAACC,GAAZ,CAAgB,UAAAC,MAAM;AAAA,uBAAIA,MAAM,CAACC,GAAX;AAAA,eAAtB,CAAZ;AAAmDzD,cAAAA,OAAO,EAAEgE,aAAa,CAACT,GAAd,CAAkB,UAAAU,QAAQ;AAAA,uBAAIA,QAAQ,CAACR,GAAb;AAAA,eAA1B,CAA5D;AAAyGxD,cAAAA,IAAI,EAAE2D,YAAY,CAACL,GAAb,CAAiB,UAAAM,OAAO;AAAA,uBAAIA,OAAO,CAACJ,GAAZ;AAAA,eAAxB,CAA/G;AAAyJvD,cAAAA,SAAS,EAATA,SAAzJ;AAAoKC,cAAAA,KAAK,EAALA,KAApK;AAA2KC,cAAAA,MAAM,EAANA,MAA3K;AAAmLC,cAAAA,gBAAgB,EAAhBA,gBAAnL;AAAqMC,cAAAA,WAAW,EAAXA,WAArM;AAAkNC,cAAAA,kBAAkB,EAAlBA,kBAAlN;AAAsOC,cAAAA,gBAAgB,EAAhBA,gBAAtO;AAAwPC,cAAAA,mBAAmB,EAAnBA,mBAAxP;AAA6QC,cAAAA,gBAAgB,EAAhBA,gBAA7Q;AAA+RC,cAAAA,QAAQ,EAARA,QAA/R;AAAySC,cAAAA,cAAc,EAAdA,cAAzS;AAAyTC,cAAAA,cAAc,EAAdA,cAAzT;AAAyUC,cAAAA,OAAO,EAAPA,OAAzU;AAAkVC,cAAAA,SAAS,EAATA,SAAlV;AAA6VC,cAAAA,cAAc,EAAdA,cAA7V;AAA6WC,cAAAA,cAAc,EAAdA,cAA7W;AAA6XC,cAAAA,cAAc,EAAdA,cAA7X;AAA6YC,cAAAA,cAAc,EAAdA,cAA7Y;AAA6ZC,cAAAA,cAAc,EAAdA,cAA7Z;AAA6aC,cAAAA,cAAc,EAAdA,cAA7a;AAA6bC,cAAAA,cAAc,EAAdA,cAA7b;AAA6cC,cAAAA,cAAc,EAAdA,cAA7c;AAA6dC,cAAAA,cAAc,EAAdA,cAA7d;AAA6eC,cAAAA,cAAc,EAAdA,cAA7e;AAA6fC,cAAAA,cAAc,EAAdA,cAA7f;AAA6gBC,cAAAA,cAAc,EAAdA,cAA7gB;AAA6hBC,cAAAA,cAAc,EAAdA,cAA7hB;AAA6iBC,cAAAA,cAAc,EAAdA,cAA7iB;AAA6jBC,cAAAA,cAAc,EAAdA,cAA7jB;AAA6kBC,cAAAA,cAAc,EAAdA,cAA7kB;AAA6lBC,cAAAA,SAAS,EAAEmC,aAAa,CAACZ,GAAd,CAAkB,UAAAa,QAAQ;AAAA,uBAAIA,QAAQ,CAACX,GAAb;AAAA,eAA1B,CAAxmB;AAAqpBxB,cAAAA,kBAAkB,EAAlBA,kBAArpB;AAAyqBC,cAAAA,eAAe,EAAfA,eAAzqB;AAA0rBC,cAAAA,UAAU,EAAEmC,UAAU,CAACf,GAAX,CAAe,UAAAgB,KAAK;AAAA,uBAAIA,KAAK,CAACd,GAAV;AAAA,eAApB,CAAtsB;AAA0uBrB,cAAAA,oBAAoB,EAApBA,oBAA1uB;AAAgwBC,cAAAA,qBAAqB,EAArBA,qBAAhwB;AAAuxBC,cAAAA,mBAAmB,EAAnBA,mBAAvxB;AAA4yBC,cAAAA,cAAc,EAAdA,cAA5yB;AAA4zBC,cAAAA,oBAAoB,EAApBA,oBAA5zB;AAAk1BC,cAAAA,iBAAiB,EAAjBA,iBAAl1B;AAAq2BC,cAAAA,gBAAgB,EAAhBA,gBAAr2B;AAAu3BC,cAAAA,eAAe,EAAfA,eAAv3B;AAAw4BC,cAAAA,iBAAiB,EAAjBA,iBAAx4B;AAA25BC,cAAAA,aAAa,EAAbA,aAA35B;AAA06BC,cAAAA,cAAc,EAAdA,cAA16B;AAA07BC,cAAAA,iBAAiB,EAAjBA;AAA17B,aAAhC,CArBT;;AAAA;AAqBhB4C,YAAAA,gBArBgB;;AAuBtB,gBAAIA,gBAAJ,EAAsB;AAClB;AACA9F,cAAAA,GAAG,CAAC6E,IAAJ,CAAS;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAAT;AACH,aAHD,MAGO;AACH;AACA9E,cAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAArB;AACH;;AA7BqB;AAAA;;AAAA;AAAA;AAAA;AAgCtBC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAjCsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdc,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAqCA,IAAMG,cAAc;AAAA,sFAAG,kBAAMhG,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEduF,YAAAA,OAFc,GAEFxF,GAAG,CAACyF,MAFF,CAEdD,OAFc;AAAA;AAAA,mBAGGnC,cAAK4C,iBAAL,CAAuBT,OAAvB,CAHH;;AAAA;AAGhBU,YAAAA,UAHgB;;AAKtB,gBAAIA,UAAJ,EAAgB;AACZjG,cAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAArB;AACH;;AAPqB;AAAA;;AAAA;AAAA;AAAA;AAStBC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAVsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdiB,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAcA,IAAMG,gBAAgB;AAAA,sFAAG,kBAAMnG,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AACpBmG,YAAAA,MADoB,GACTpG,GAAG,CAACE,IADK,CACpBkG,MADoB;AAAA;AAAA;AAAA,mBAGJ/C,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAEmD;AAAjB,aAAX,EAAsC7C,IAAtC,GAA6C6B,QAA7C,CAAsD,UAAtD,EACfA,QADe,CACN,MADM,EAEfA,QAFe,CAEN,SAFM,EAGfA,QAHe,CAGN,WAHM,EAIfA,QAJe,CAIN,YAJM,CAHI;;AAAA;AAGlBkB,YAAAA,KAHkB;;AAAA,kBAQpBA,KAAK,CAAChB,MAAN,GAAe,CARK;AAAA;AAAA;AAAA;;AASpBrF,YAAAA,GAAG,CAAC2F,IAAJ,CAASU,KAAT;AAToB;AAAA;;AAAA;AAAA,8CAWbrG,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CAXa;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAcxBC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAfwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBoB,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;;;AAmBA,IAAMI,kBAAkB;AAAA,sFAAG,kBAAMvG,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AACtBuG,YAAAA,QADsB,GACTxG,GAAG,CAACE,IADK,CACtBsG,QADsB;AAAA;AAAA;AAAA,mBAGNnD,cAAKgD,KAAL,CAAW;AAAEnD,cAAAA,cAAc,EAAEsD;AAAlB,aAAX,EAAyCjD,IAAzC,GAAgD6B,QAAhD,CAAyD,UAAzD,EACfA,QADe,CACN,MADM,EAEfA,QAFe,CAEN,SAFM,EAGfA,QAHe,CAGN,WAHM,EAIfA,QAJe,CAIN,YAJM,CAHM;;AAAA;AAGpBkB,YAAAA,KAHoB;;AAQ1B,gBAAIA,KAAK,CAAChB,MAAN,GAAe,CAAnB,EAAsB;AAClBrF,cAAAA,GAAG,CAAC6E,IAAJ,CAASwB,KAAT;AACH,aAFD,MAEO;AACHrG,cAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAArB;AACH;;AAZyB;AAAA;;AAAA;AAAA;AAAA;AAc1BC,YAAAA,OAAO,CAACC,GAAR;AACAhF,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAf0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBwB,kBAAkB;AAAA;AAAA;AAAA,GAAxB;;;;AAmBA,IAAME,wBAAwB;AAAA,sFAAG,kBAAMzG,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEToD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE;AAAjB,aAAX,EAA2CyD,cAA3C,EAFS;;AAAA;AAE1BC,YAAAA,QAF0B;;AAAA,kBAG5BA,QAAQ,GAAG,CAHiB;AAAA;AAAA;AAAA;;AAI5B1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJ4B;AAAA;;AAAA;AAAA,8CAMrB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANqB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAShCC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAVgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAxB0B,wBAAwB;AAAA;AAAA;AAAA,GAA9B;;;;AAcA,IAAMI,oBAAoB;AAAA,sFAAG,kBAAM7G,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAELoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE;AAAjB,aAAX,EAAuCyD,cAAvC,EAFK;;AAAA;AAEtBC,YAAAA,QAFsB;;AAAA,iBAGxBA,QAHwB;AAAA;AAAA;AAAA;;AAIxB1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJwB;AAAA;;AAAA;AAAA,8CAMjB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANiB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS5BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApB8B,oBAAoB;AAAA;AAAA;AAAA,GAA1B;;;;AAcA,IAAMC,wBAAwB;AAAA,uFAAG,mBAAM9G,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEToD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,WAAjB;AAA8BC,cAAAA,cAAc,EAAE;AAA9C,aAAX,EAAuEwD,cAAvE,EAFS;;AAAA;AAE1BC,YAAAA,QAF0B;;AAAA,iBAG5BA,QAH4B;AAAA;AAAA;AAAA;;AAI5B1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJ4B;AAAA;;AAAA;AAAA,+CAMrB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANqB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAShCC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAVgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAxB+B,wBAAwB;AAAA;AAAA;AAAA,GAA9B;;;;AAcA,IAAMC,oBAAoB;AAAA,uFAAG,mBAAM/G,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAELoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,WAAjB;AAA8BC,cAAAA,cAAc,EAAE;AAA9C,aAAX,EAAmEwD,cAAnE,EAFK;;AAAA;AAEtBC,YAAAA,QAFsB;;AAAA,iBAGxBA,QAHwB;AAAA;AAAA;AAAA;;AAIxB1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJwB;AAAA;;AAAA;AAAA,+CAMjB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANiB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS5BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApBgC,oBAAoB;AAAA;AAAA;AAAA,GAA1B;;;;AAcA,IAAMC,oBAAoB;AAAA,uFAAG,mBAAMhH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAELoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,OAAjB;AAA0BC,cAAAA,cAAc,EAAE;AAA1C,aAAX,EAAmEwD,cAAnE,EAFK;;AAAA;AAEtBC,YAAAA,QAFsB;;AAAA,iBAGxBA,QAHwB;AAAA;AAAA;AAAA;;AAIxB1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJwB;AAAA;;AAAA;AAAA,+CAMjB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANiB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS5BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApBiC,oBAAoB;AAAA;AAAA;AAAA,GAA1B;;;;AAcA,IAAMC,gBAAgB;AAAA,uFAAG,mBAAMjH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEDoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,OAAjB;AAA0BC,cAAAA,cAAc,EAAE;AAA1C,aAAX,EAA+DwD,cAA/D,EAFC;;AAAA;AAElBC,YAAAA,QAFkB;;AAAA,iBAGpBA,QAHoB;AAAA;AAAA;AAAA;;AAIpB1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJoB;AAAA;;AAAA;AAAA,+CAMb1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANa;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AASxBC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAVwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBkC,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;;;AAcA,IAAMC,uBAAuB;AAAA,uFAAG,mBAAMlH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAERoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE;AAAjB,aAAX,EAA0CyD,cAA1C,EAFQ;;AAAA;AAEzBC,YAAAA,QAFyB;;AAAA,iBAG3BA,QAH2B;AAAA;AAAA;AAAA;;AAI3B1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJ2B;AAAA;;AAAA;AAAA,+CAMpB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANoB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS/BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAvBmC,uBAAuB;AAAA;AAAA;AAAA,GAA7B;;;;AAcA,IAAMC,uBAAuB;AAAA,uFAAG,mBAAMnH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAERoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,UAAjB;AAA6BC,cAAAA,cAAc,EAAE;AAA7C,aAAX,EAAsEwD,cAAtE,EAFQ;;AAAA;AAEzBC,YAAAA,QAFyB;;AAAA,iBAG3BA,QAH2B;AAAA;AAAA;AAAA;;AAI3B1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJ2B;AAAA;;AAAA;AAAA,+CAMpB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANoB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS/BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAvBoC,uBAAuB;AAAA;AAAA;AAAA,GAA7B;;;;AAcA,IAAMC,mBAAmB;AAAA,uFAAG,mBAAMpH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEJoD,cAAKgD,KAAL,CAAW;AAAEpD,cAAAA,aAAa,EAAE,UAAjB;AAA6BC,cAAAA,cAAc,EAAE;AAA7C,aAAX,EAAkEwD,cAAlE,EAFI;;AAAA;AAErBC,YAAAA,QAFqB;;AAAA,iBAGvBA,QAHuB;AAAA;AAAA;AAAA;;AAIvB1G,YAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AAJuB;AAAA;;AAAA;AAAA,+CAMhB1G,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CANgB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAS3BC,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAV2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAnBqC,mBAAmB;AAAA;AAAA;AAAA,GAAzB;;;;AAcA,IAAMC,sBAAsB;AAAA,uFAAG,mBAAMrH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEPoD,cAAKiE,SAAL,CAAe,CAAC;AACnCC,cAAAA,OAAO,EAAE;AAD0B,aAAD,EAEnC;AACCC,cAAAA,MAAM,EAAE;AACJ3D,gBAAAA,GAAG,EAAE,WADD;AAEJ4D,gBAAAA,UAAU,EAAE;AAAEC,kBAAAA,IAAI,EAAE;AAAR;AAFR;AADT,aAFmC,CAAf,CAFO;;AAAA;AAExBf,YAAAA,QAFwB;;AAU9B,gBAAIA,QAAJ,EAAc;AACV1G,cAAAA,GAAG,CAAC6E,IAAJ,CAAS6B,QAAT;AACH;;AAZ6B;AAAA;;AAAA;AAAA;AAAA;AAc9B3B,YAAAA,OAAO,CAAC4B,KAAR;AACA3G,YAAAA,GAAG,CAACiF,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB;;AAf8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAtBsC,sBAAsB;AAAA;AAAA;AAAA,GAA5B","sourcesContent":["import Sale from '../models/Sale'\r\nimport Vehicle from '../models/Vehicle'\r\nimport Seller from '../models/Seller'\r\nimport Customer from '../models/Customer'\r\nimport Campaign from '../models/Campaign'\r\nimport Props from '../models/Props'\r\n\r\nexport const createSale = async(req, res) => {\r\n    try {\r\n        const { vendedor, cliente, auto, serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, campanias, descuento_autonort, observacion_adv, accesorios, condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion } = req.body;\r\n\r\n        const newSale = new Sale({ serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, descuento_autonort, observacion_adv, condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion });\r\n\r\n        //Seller\r\n        const foundSeller = await Seller.find({ name: { $in: vendedor } });\r\n        newSale.vendedor = foundSeller.map(seller => seller._id);\r\n\r\n        //Vehicle\r\n        const foundVehicle = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n        newSale.auto = foundVehicle.map(vehicle => vehicle._id);\r\n\r\n        //Customer\r\n        const foundCustomer = await Customer.find({ document: { $in: cliente } });\r\n        newSale.cliente = foundCustomer.map(customer => customer._id);\r\n\r\n        //Campaign\r\n        const foundCampaign = await Campaign.find({ name: { $in: campanias } });\r\n        newSale.campanias = foundCampaign.map(campaign => campaign._id);\r\n\r\n        //Props\r\n        const foundProps = await Props.find({ name: { $in: accesorios } });\r\n        newSale.accesorios = foundProps.map(props => props._id);\r\n\r\n        //console.log(newSale);\r\n        const saleSaved = await newSale.save();\r\n        if (saleSaved) {\r\n            res.json({ message: 'Expediente creado con éxito' });\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(403).json({ message: 'No autorizado' })\r\n    }\r\n}\r\n\r\nexport const getSales = async(req, res) => {\r\n    try {\r\n        const ventasfull = await Sale.find()\r\n            .populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('accesorios');\r\n\r\n        if (ventasfull.length > 0) {\r\n            res.json(ventasfull);\r\n        } else {\r\n            return res.status(201).json({ message: 'No Existen Expedientes' })\r\n        }\r\n\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.json({ message: 'Error interno' })\r\n    }\r\n}\r\n\r\nexport const getSaleById = async(req, res) => {\r\n    try {\r\n        const { salesId } = req.params;\r\n        const venta = await Sale.findById(salesId)\r\n            .populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('accesorios');\r\n\r\n        if (venta) {\r\n            res.send(venta);\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const updateSaleById = async(req, res) => {\r\n    try {\r\n        const { salesId } = req.params;\r\n\r\n        const { vendedor, cliente, auto, serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, campanias, descuento_autonort, observacion_adv, accesorios, condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion } = req.body;\r\n\r\n        //Seller\r\n        const foundSeller = await Seller.find({ name: { $in: vendedor } });\r\n\r\n        //Vehicle\r\n        const foundVehicle = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n\r\n        //Customer\r\n        const foundCustomer = await Customer.find({ document: { $in: cliente } });\r\n\r\n        //Campaign\r\n        const foundCampaign = await Campaign.find({ name: { $in: campanias } });\r\n\r\n        //Props\r\n        const foundProps = await Props.find({ name: { $in: accesorios } });\r\n\r\n        const ventaActualizada = await Sale.findByIdAndUpdate(salesId, { vendedor: foundSeller.map(seller => seller._id), cliente: foundCustomer.map(customer => customer._id), auto: foundVehicle.map(vehicle => vehicle._id), serie_tdp, color, precio, anio_fabricacion, anio_modelo, ubicacion_vehiculo, estatus_vehiculo, tipo_financiamiento, entidad_bancaria, sustento, fecha_sustento, monto_aprobado, oficina, ejecutivo, montoAdelanto1, fechaAdelanto1, montoAdelanto2, fechaAdelanto2, montoAdelanto3, fechaAdelanto3, montoAdelanto4, fechaAdelanto4, montoAdelanto5, fechaAdelanto5, montoAdelanto6, fechaAdelanto6, montoAdelanto7, fechaAdelanto7, montoAdelanto8, fechaAdelanto8, campanias: foundCampaign.map(campaign => campaign._id), descuento_autonort, observacion_adv, accesorios: foundProps.map(props => props._id), condicion_accesorios, fecha_facturacion_tdp, estatus_facturacion, tipo_operacion, fecha_inicio_reserva, fecha_fin_reserva, tipo_comprobante, nro_comprobante, fecha_comprobante, estatus_venta, sucursal_venta, fecha_cancelacion });\r\n\r\n        if (ventaActualizada) {\r\n            //Mandamos la respuesta\r\n            res.json({ message: 'Expediente actualizado con éxito' });\r\n        } else {\r\n            //Mandamos la respuesta\r\n            res.status(403).json({ message: 'No Autorizado' });\r\n        }\r\n\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(401).json({ message: 'Error interno' })\r\n    }\r\n}\r\n\r\nexport const deleteSaleById = async(req, res) => {\r\n    try {\r\n        const { salesId } = req.params;\r\n        const deleteSale = await Sale.findByIdAndDelete(salesId);\r\n\r\n        if (deleteSale) {\r\n            res.status(200).json({ message: 'Expediente eliminado con éxito' });\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Error interno' })\r\n    }\r\n}\r\n\r\nexport const UnidadesByStatus = async(req, res) => {\r\n    const { estado } = req.body;\r\n    try {\r\n        const query = await Sale.where({ estatus_venta: estado }).find().populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('accesorios');\r\n        if (query.length > 0) {\r\n            res.send(query);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(403).json({ message: 'No Autorizado' });\r\n    }\r\n}\r\n\r\nexport const UnidadesBySucursal = async(req, res) => {\r\n    const { sucursal } = req.body;\r\n    try {\r\n        const query = await Sale.where({ sucursal_venta: sucursal }).find().populate('vendedor')\r\n            .populate('auto')\r\n            .populate('cliente')\r\n            .populate('campanias')\r\n            .populate('accesorios');\r\n        if (query.length > 0) {\r\n            res.json(query);\r\n        } else {\r\n            res.status(201).json({ message: 'No Existen Unidades' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesCanceladas = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Cancelado' }).countDocuments();\r\n        if (consulta > 0) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Canceladas' });\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesLibres = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Libre' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Libres' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoTarapotoCanceladas = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Cancelado', sucursal_venta: 'Tarapoto' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Canceladas en Tarapoto' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoJaenCanceladas = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Cancelado', sucursal_venta: 'Jaén' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Canceladas en Jaén' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoTarapotoLibres = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Libre', sucursal_venta: 'Tarapoto' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Libres en Tarapoto' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoJaenLibres = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Libre', sucursal_venta: 'Jaén' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades Libres en Jaén' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoUnidadesAnticipos = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Anticipo' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades en Anticipo' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoTarapotoAnticipos = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Anticipo', sucursal_venta: 'Tarapoto' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades en Anticipo en Tarapoto' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoJaenAnticipos = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.where({ estatus_venta: 'Anticipo', sucursal_venta: 'Jaén' }).countDocuments();\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Unidades en Anticipo en Jaén' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' })\r\n    }\r\n}\r\n\r\nexport const conteoVentasByVendedor = async(req, res) => {\r\n    try {\r\n        const consulta = await Sale.aggregate([{\r\n            $unwind: '$vendedor'\r\n        }, {\r\n            $group: {\r\n                _id: \"$vendedor\",\r\n                num_ventas: { $sum: 1 }\r\n            }\r\n        }]);\r\n        if (consulta) {\r\n            res.json(consulta);\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        res.status(403).json({ message: 'No Autorizado' });\r\n    }\r\n}"],"file":"sale.controller.js"}