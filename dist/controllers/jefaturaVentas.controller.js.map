{"version":3,"sources":["../../src/controllers/jefaturaVentas.controller.js"],"names":["jefaturaCtrl","getAll","req","res","JefaturaVentas","find","populate","query","length","json","status","message","console","error","createOne","body","name","email","area","sucursal","createdBy","newObj","User","username","$in","userFound","map","a","_id","save","updateById","jefaturaId","params","findByIdAndUpdate","deleteById","findByIdAndDelete","obtenerJefexSucursal","findOne","select","asesor","log"],"mappings":"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","sourcesContent":["import JefaturaVentas from \"../models/JefaturaVentas\";\r\nimport User from \"../models/User\";\r\n\r\nconst jefaturaCtrl = {};\r\n\r\njefaturaCtrl.getAll = async(req, res) => {\r\n    try {\r\n        const query = await JefaturaVentas.find().populate('createdBy', 'name');\r\n\r\n        if (query.length > 0) {\r\n            res.json(query);\r\n        } else {\r\n            return res.status(404).json({ message: 'No existen jefes' })\r\n        }\r\n    } catch (err) {\r\n        console.error(err)\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\njefaturaCtrl.createOne = async(req, res) => {\r\n\r\n    const { name, email, area, sucursal, createdBy } = req.body;\r\n\r\n    try {\r\n\r\n        const newObj = new JefaturaVentas({ name, email, area, sucursal });\r\n\r\n        const userFound = await User.find({ username: { $in: createdBy } })\r\n        newObj.createdBy = userFound.map(a => a._id)\r\n\r\n        const query = await newObj.save();\r\n        if (query) {\r\n            res.json({ message: 'Jefe creada con éxito' });\r\n        }\r\n    } catch (err) {\r\n        console.error(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\njefaturaCtrl.updateById = async(req, res) => {\r\n    const { jefaturaId } = req.params;\r\n    const { name, email, area, sucursal } = req.body;\r\n\r\n    try {\r\n        const query = await JefaturaVentas.findByIdAndUpdate(jefaturaId, {\r\n            name,\r\n            email,\r\n            area,\r\n            sucursal\r\n        });\r\n        if (query) {\r\n            res.json({ message: 'Jefe actualizado con éxito' });\r\n        } else {\r\n            res.status(404).json({ message: 'No existe Jefe a actualizar' });\r\n        }\r\n    } catch (err) {\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\njefaturaCtrl.deleteById = async(req, res) => {\r\n    const { jefaturaId } = req.params;\r\n\r\n    try {\r\n        const query = await JefaturaVentas.findByIdAndDelete(jefaturaId);\r\n        if (query) {\r\n            res.json({ message: 'Jefe eliminado con éxito' });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe Jefe a eliminar' });\r\n        }\r\n    } catch (err) {\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\njefaturaCtrl.obtenerJefexSucursal = async(req, res) => {\r\n    const { sucursal, area } = req.body\r\n\r\n    try {\r\n        const query = await JefaturaVentas.findOne({ sucursal: sucursal, area: area, status: true }).select('name email');\r\n\r\n        if (query) {\r\n            res.json({ asesor: query })\r\n        } else {\r\n            return res.status(404).json({ message: 'No se encontraron asesores' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport default jefaturaCtrl;"],"file":"jefaturaVentas.controller.js"}