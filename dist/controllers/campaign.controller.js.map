{"version":3,"sources":["../../src/controllers/campaign.controller.js"],"names":["createCampaign","req","res","body","name","descripcion","bono","startDate","endDate","status","newCampaign","Campaign","save","campaignSaved","json","message","console","log","getAll","find","campaign","send","getOne","campaignId","params","findById","campaigns","getCampaniasActivas","activos","getCampaignByVehicle","modelo","Vehicle","findOne","cod_tdp","vehiculo","auto","campana","updateCampaignById","findByIdAndUpdate","new","updateCampaign","deleteCampaignById","findByIdAndRemove","deletedCampaign"],"mappings":"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","sourcesContent":["import Campaign from '../models/Campaign'\r\nimport Vehicle from '../models/Vehicle'\r\n\r\nexport const createCampaign = async(req, res) => {\r\n    try {\r\n        const { name, descripcion, bono, startDate, endDate, status } = req.body;\r\n        const newCampaign = new Campaign({ name, descripcion, bono, startDate, endDate, status });\r\n\r\n        //const foundAuto = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n        //newCampaign.auto = foundAuto.map(auto => auto._id);\r\n\r\n        const campaignSaved = await newCampaign.save();\r\n\r\n        if (campaignSaved) {\r\n            res.json({ message: 'Campaña creada con éxito' });\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Campaña ya existe' })\r\n    }\r\n}\r\n\r\nexport const getAll = async(req, res) => {\r\n    try {\r\n        const campaign = await Campaign.find();\r\n        if (campaign) {\r\n            res.send(campaign);\r\n        } else {\r\n            return res.status(201).json({ message: 'No existen Campañas' })\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: `${e}` })\r\n    }\r\n}\r\n\r\nexport const getOne = async(req, res) => {\r\n    try {\r\n        const { campaignId } = req.params;\r\n        const campaigns = await Campaign.findById(campaignId);\r\n        if (campaigns) {\r\n            res.json(campaigns);\r\n        } else {\r\n            res.status(201).json({ message: 'No existe la campaña' })\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Error de Servidor' })\r\n    }\r\n}\r\n\r\nexport const getCampaniasActivas = async(req, res) => {\r\n    try {\r\n        const activos = await Campaign.find({ status: 'Activo' });\r\n        if (activos) {\r\n            res.json(activos);\r\n        }\r\n    } catch (err) {\r\n        res.status(404).json({ message: 'Erro de Servidor' });\r\n        console.log(err);\r\n    }\r\n}\r\n\r\nexport const getCampaignByVehicle = async(req, res) => {\r\n    try {\r\n        const { modelo } = req.body;\r\n\r\n        const vehiculo = await Vehicle.findOne({ cod_tdp: modelo })\r\n\r\n        const campana = await Campaign.find({ auto: vehiculo });\r\n\r\n        if (campana) {\r\n            //console.log(campana);\r\n            res.json(campana);\r\n        } else {\r\n            res.status(201).json({ message: 'No existen campañas para ese vehículo' });\r\n        }\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Error filtrando Campañas' });\r\n    }\r\n}\r\n\r\nexport const updateCampaignById = async(req, res) => {\r\n    try {\r\n        const { campaignId } = req.params;\r\n\r\n        const { name, descripcion, bono, startDate, endDate, status } = req.body;\r\n\r\n        //const foundAuto = await Vehicle.find({ cod_tdp: { $in: auto } });\r\n\r\n        const updateCampaign = await Campaign.findByIdAndUpdate(campaignId, { name, descripcion, bono, startDate, endDate, status }, { new: true });\r\n        if (updateCampaign) {\r\n            res.json({ message: 'Campaña actualizada con éxito' });\r\n        } else {\r\n            res.status(201).json({ message: 'Campaña no existe' });\r\n        }\r\n\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Error al actualizar la campaña' })\r\n    }\r\n}\r\n\r\nexport const deleteCampaignById = async(req, res) => {\r\n    try {\r\n        const { campaignId } = req.params;\r\n        const deletedCampaign = await Campaign.findByIdAndRemove(campaignId);\r\n        if (deletedCampaign) {\r\n            res.json({ message: 'Campaña eliminada con éxito' });\r\n        } else {\r\n            res.status(201).json({ message: 'Campaña no existe' });\r\n        }\r\n\r\n    } catch (e) {\r\n        console.log(e);\r\n        res.status(404).json({ message: 'Error al eliminar la campaña' })\r\n    }\r\n}"],"file":"campaign.controller.js"}