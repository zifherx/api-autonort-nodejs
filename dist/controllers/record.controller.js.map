{"version":3,"sources":["../../src/controllers/record.controller.js"],"names":["createRecord","req","res","body","fecha_recepcion","hora_recepcion","sales","fecha_ingreso_file","hora_ingreso_file","num_titulo","status_tarjeta","num_placa","fecha_entrega_file","fecha_tramite_placa","status_placa","fecha_entrega_placa","fecha_entrega_cliente","nuevoInmatriculado","Record","Sale","find","nro_comprobante","$in","expediente","map","_id","save","recordSaved","json","message","console","log","status","getRecords","filtro1","path","populate","expedientes","length","getRecordById","recordId","params","findById","updateRecordById","foundExpediente","findByIdAndUpdate","objetoActualizado","deleteRecordById","findByIdAndDelete","deleteRecord"],"mappings":"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","sourcesContent":["import Record from '../models/Record'\r\nimport Sale from '../models/Sale'\r\n\r\nexport const createRecord = async(req, res) => {\r\n    const { fecha_recepcion, hora_recepcion, sales, fecha_ingreso_file, hora_ingreso_file, num_titulo, status_tarjeta, num_placa, fecha_entrega_file, fecha_tramite_placa, status_placa, fecha_entrega_placa, fecha_entrega_cliente } = req.body;\r\n\r\n    try {\r\n\r\n        const nuevoInmatriculado = new Record({ fecha_recepcion, hora_recepcion, fecha_ingreso_file, hora_ingreso_file, num_titulo, status_tarjeta, num_placa, fecha_entrega_file, fecha_tramite_placa, status_placa, fecha_entrega_placa, fecha_entrega_cliente });\r\n\r\n        //Sales\r\n        const expediente = await Sale.find({ nro_comprobante: { $in: sales } });\r\n        nuevoInmatriculado.sales = expediente.map(sales => sales._id);\r\n\r\n        const recordSaved = await nuevoInmatriculado.save();\r\n\r\n        if (recordSaved) {\r\n            res.json({ message: 'Inmatriculado creado con éxito' });\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(409).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const getRecords = async(req, res) => {\r\n    const filtro1 = { path: 'sales', populate: { path: 'auto vendedor cliente' } };\r\n\r\n    try {\r\n        const expedientes = await Record.find().populate(filtro1)\r\n\r\n        if (expedientes.length > 0) {\r\n            res.json(expedientes);\r\n        } else {\r\n            return res.status(404).json({ message: 'No existen Inmatriculados' })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(409).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const getRecordById = async(req, res) => {\r\n    const { recordId } = req.params;\r\n\r\n    const filtro1 = { path: 'sales', populate: { path: 'auto vendedor  cliente' } };\r\n\r\n    try {\r\n\r\n        const expediente = await Record.findById(recordId).populate(filtro1);\r\n\r\n        if (expediente) {\r\n            res.json(expediente);\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe el Inmatriculado' });\r\n        }\r\n\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(409).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const updateRecordById = async(req, res) => {\r\n    const { recordId } = req.params;\r\n\r\n    const { fecha_recepcion, hora_recepcion, sales, fecha_ingreso_file, hora_ingreso_file, num_titulo, status_tarjeta, num_placa, fecha_entrega_file, fecha_tramite_placa, status_placa, fecha_entrega_placa, fecha_entrega_cliente } = req.body;\r\n\r\n    try {\r\n\r\n        //Expediente\r\n        const foundExpediente = await Sale.find({ nro_comprobante: { $in: sales } });\r\n\r\n        const objetoActualizado = await Record.findByIdAndUpdate(recordId, { fecha_recepcion, hora_recepcion, sales: foundExpediente.map(expediente => expediente._id), fecha_ingreso_file, hora_ingreso_file, num_titulo, status_tarjeta, num_placa, fecha_entrega_file, fecha_tramite_placa, status_placa, fecha_entrega_placa, fecha_entrega_cliente });\r\n\r\n        if (objetoActualizado) {\r\n            res.json({ message: 'Inmatriculado actualizado con éxito' });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe Inmatriculado a actualizar' });\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(409).json({ message: err.message })\r\n    }\r\n}\r\n\r\nexport const deleteRecordById = async(req, res) => {\r\n    const { recordId } = req.params;\r\n\r\n    try {\r\n        const deleteRecord = await Record.findByIdAndDelete(recordId);\r\n\r\n        if (deleteRecord) {\r\n            res.json({ message: 'Inmatriculado eliminado con éxito' });\r\n        } else {\r\n            return res.status(404).json({ message: 'No existe Inmatriculado a eliminar' });\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        res.status(409).json({ message: err.message })\r\n    }\r\n}"],"file":"record.controller.js"}