{"version":3,"file":"tcambio.controller.js","names":["tCambioController","getAll","req","res","TCambio","find","sort","fecha_registro","populate","path","select","query","length","json","total","all","status","message","console","log","getOneById","itemId","params","findById","one","createOne","body","codigo_interno","itemsBBVA","itemsBCP","ventaVehiculosPromedio","ventaRepuestosPromedio","licitacionesPromedio","createdBy","newObj","User","findOne","username","userFound","_id","save"],"sources":["../../src/controllers/tcambio.controller.js"],"sourcesContent":["import TCambio from '../models/TCambio';\r\nimport User from '../models/User';\r\n\r\nconst tCambioController = {};\r\n\r\ntCambioController.getAll = async(req, res) => {\r\n    try {\r\n        const query = await TCambio.find()\r\n        .sort({fecha_registro: -1})\r\n        .populate({\r\n            path: 'createdBy',\r\n            select: 'name username'\r\n        });\r\n\r\n        if(query.length > 0){\r\n            res.json({total: query.length, all: query});\r\n        }else{\r\n            return res.status(404).json({message: `No existen registros`});\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({message: err.message});\r\n    }\r\n}\r\n\r\ntCambioController.getOneById = async (req, res) => {\r\n    const { itemId } = req.params;\r\n\r\n    try {\r\n        const query = await TCambio.findById(itemId);\r\n\r\n        if (query) {\r\n            res.json({one: query});\r\n        } else {\r\n            return res.status(404).json({ message: `No existe registro` })\r\n        }\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({message: err.message});\r\n    }\r\n}\r\n\r\ntCambioController.createOne = async(req, res) => {\r\n    const { codigo_interno, fecha_registro, itemsBBVA, itemsBCP, ventaVehiculosPromedio, ventaRepuestosPromedio, licitacionesPromedio, createdBy } = req.body;\r\n\r\n    try {\r\n        const newObj = new TCambio({\r\n            codigo_interno,\r\n            fecha_registro,\r\n            itemsBBVA,\r\n            itemsBCP,\r\n            ventaVehiculosPromedio,\r\n            ventaRepuestosPromedio,\r\n            licitacionesPromedio\r\n        });\r\n\r\n        const userFound = await User.findOne({username: createdBy});\r\n        if(!userFound) return res.status(404).json({message: `Usuario ${createdBy} no encontrado`});\r\n        newObj.createdBy = userFound._id;\r\n\r\n        const query = await newObj.save();\r\n\r\n        if(query) return res.json({message: `T. Cambio registrado con Ã©xito`});\r\n    } catch (err) {\r\n        console.log(err);\r\n        return res.status(503).json({message: err.message});\r\n    }\r\n}\r\n\r\nexport default tCambioController;"],"mappings":"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"}